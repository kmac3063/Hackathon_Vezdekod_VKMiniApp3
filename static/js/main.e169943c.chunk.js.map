{"version":3,"sources":["panels/Home.js","App.js","index.js"],"names":["Home","id","pos","go","fetchedUser","gyrData","useState","X","setX","Y","setY","a","b","c","useEffect","move","x","y","contain","w","isValid","walls","getWalls","N","CELL_WIDTH","CELL_HEIGHT","d","i","length","dx","dy","undefined","isNaN","MAP_WIDTH","MAP_HEIGHT","console","log","m","wls","j","push","style","backgroundColor","margin","width","height","padding","map","position","left","top","marginTop","marginBottom","z","App","activePanel","setActivePanel","setUser","size","popout","setPopout","setPos","gyr","bridge","send","user","setInterval","subscribe","detail","type","data","schemeAttribute","document","createAttribute","value","scheme","body","attributes","setNamedItem","fetchData","fakeGyr","e","currentTarget","dataset","to","ReactDOM","render","getElementById"],"mappings":"uNA0IeA,EArIF,SAAC,GAAyC,IAAxCC,EAAuC,EAAvCA,GAAqBC,GAAkB,EAAnCC,GAAmC,EAA/BC,YAA+B,EAAlBF,KAAKG,EAAa,EAAbA,QACrC,EAAkBC,mBAAS,GAA3B,mBAAOC,EAAP,KAAUC,EAAV,KACA,EAAkBF,mBAAS,GAA3B,mBAAOG,EAAP,KAAUC,EAAV,KACA,EAAoBJ,mBAAS,GAA7B,mBACA,GADA,UACoBA,mBAAS,IAA7B,mBACA,GADA,UACkBA,mBAAS,CAACK,EAAE,EAAGC,EAAE,EAAGC,EAAE,KAAxC,6BAWAC,qBAAU,WAGNC,EAAKb,EAAIc,EAAGd,EAAIe,KACjB,CAACf,IAEJ,IAAMgB,EAAU,SAACC,EAAGR,GAChB,OAAOQ,EAAE,IAAMR,EAAE,IAAMA,EAAE,IAAMQ,EAAE,GAflB,IAgBXA,EAAE,IAAMR,EAAE,IAAMA,EAAE,IAAMQ,EAAE,GAfd,IAkBdC,EAAU,SAACJ,EAAGC,GAChB,IAAMI,EAAQC,IACd,GAAIN,EAAI,GAAKA,GAhBCO,KAgBiBN,EAAI,GAAKA,GAfzBM,IAe0C,OAAO,EAUhE,IANA,IAAIZ,EAAI,CAACK,EAAGC,GACRL,EAAI,CAACI,EAxBMQ,GAwBUP,GACrBJ,EAAI,CAACG,EAAGC,EAxBIQ,IAyBZC,EAAI,CAACV,EA1BMQ,GA0BUP,EAzBTQ,IA4BPE,EAAI,EAAGA,EAAIN,EAAMO,OAAQD,IAAK,CACnC,IAAIR,EAAIE,EAAMM,GACd,GAAIT,EAAQC,EAAGR,IAAMO,EAAQC,EAAGP,IAAMM,EAAQC,EAAGN,IAAMK,EAAQC,EAAGO,GAC9D,OAAO,EAEf,OAAO,GAGLX,EAAO,SAACc,EAAIC,GACd,IAAId,EAAIT,EACJU,EAAIR,QACEsB,IAANf,GAAmBgB,MAAMhB,MACzBA,EAAIiB,WAEEF,IAANd,GAAmBe,MAAMf,MACzBA,EAAIiB,KAERC,QAAQC,IAAIpB,EAAI,IAAMC,GAClBG,EAAQJ,EAAIa,EAAIZ,GAChBD,GAAKa,EAELb,GAAKa,EACLT,EAAQJ,EAAEC,EAAIa,GACdb,GAAKa,EAELb,GAAKa,EAETtB,EAAKQ,GACLN,EAAKO,IAIHK,EAAW,WAmBb,IAlBA,IAAIe,EAAI,CACJ,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,oBACAC,EAAM,GACDX,EAAI,EAAGA,EAnFV,GAmFiBA,IACnB,IAAK,IAAIY,EAAI,EAAGA,EApFd,GAoFqBA,IACH,MAAZF,EAAEV,GAAGY,IACLD,EAAIE,KAAK,CArFN,GAqFOD,EApFN,GAoFsBZ,IAGtC,OAAOW,GAELjB,EAAQC,IAEd,OACI,eAAC,IAAD,CAAOrB,GAAIA,EAAIwC,MAAO,CAACC,gBAAiB,WAAxC,UACI,cAAC,IAAD,CAAKD,MAAO,CAACE,OAAQ,OAAQC,MAAO,QAASC,OAAQ,QAASC,QAAS,OAAvE,SACKzB,EAAM0B,KAAI,SAAC5B,GACR,OAAO,cAAC,IAAD,CACKsB,MAAO,CAACO,SAAU,QACdF,QAAQ,IACRF,MAnGb,GAmG+BC,OAlG9B,GAmGYI,KAAM9B,EAAE,GAAI+B,IAAK/B,EAAE,GAAIuB,gBAAiB,YAJhC,IAAPvB,EAAE,GAAWA,EAAE,SASxC,cAAC,IAAD,CAAKsB,MAAO,CAACO,SAAU,WACnBF,QAAQ,IACRF,MAzGOpB,GAyGWqB,OAxGVpB,GAyGRwB,KAAM1C,EAAG2C,IAAKzC,EACdiC,gBAAiB,aACrB,cAAC,IAAD,gBACA,eAAC,IAAD,CAAKD,MAAO,CAACU,UAAU,OAAQC,aAAa,KAA5C,eACO/C,EAAQW,KAEf,eAAC,IAAD,gBACOX,EAAQY,KAEf,eAAC,IAAD,gBACOZ,EAAQgD,SCrEZC,EAvDH,WACX,MAAsChD,mBAAS,QAA/C,mBAAOiD,EAAP,KAAoBC,EAApB,KACA,EAA+BlD,mBAAS,MAAxC,mBAAOF,EAAP,KAAoBqD,EAApB,KACA,EAA4BnD,mBAAS,cAAC,IAAD,CAAeoD,KAAK,WAAzD,mBAAOC,EAAP,KAAeC,EAAf,KACA,EAAsBtD,mBAAS,CAAC,EAAG,IAAnC,mBAAOJ,EAAP,KAAY2D,EAAZ,KACA,EAAsBvD,mBAAS,CAACU,EAAE,EAAEC,EAAE,EAAEoC,EAAE,IAA1C,mBAAOS,EAAP,UAMAhD,qBAAU,WAAM,4CAaf,4BAAAH,EAAA,6DACCoD,IAAOC,KAAK,yBAA0B,CAAC,aAAgB,MACvDJ,EAAU,MAFX,SAGoBG,IAAOC,KAAK,uBAHhC,OAGOC,EAHP,OAICR,EAAQQ,GAJT,4CAbe,kEAmBf,sBAAAtD,EAAA,sDACCuD,aAAY,WAEXL,EAAO,CAAC7C,EAAE,EAAGC,GAAG,MACd,KAJJ,4CAnBe,sBACf8C,IAAOI,WAAU,YAAgC,IAAD,IAA5BC,OAAUC,EAAkB,EAAlBA,KAAMC,EAAY,EAAZA,KACnC,GAAa,yBAATD,EAAiC,CACpC,IAAME,EAAkBC,SAASC,gBAAgB,UACjDF,EAAgBG,MAAQJ,EAAKK,OAASL,EAAKK,OAAS,eACpDH,SAASI,KAAKC,WAAWC,aAAaP,OACnB,6BAATF,GACVR,EAAO,CAAC7C,EAAY,GAATsD,EAAKtD,EAAQC,EAAY,GAATqD,EAAKrD,OAPnB,mCAyBf8D,GAzBe,mCA0BfC,KACE,IAMH,OACC,cAAC,IAAD,UACC,cAAC,IAAD,UACC,cAAC,IAAD,CAAMzB,YAAaA,EAAaI,OAAQA,EAAxC,SACC,cAAC,EAAD,CAAM1D,GAAG,OAAOG,YAAaA,EAAaD,GARnC,SAAA8E,GACVzB,EAAeyB,EAAEC,cAAcC,QAAQC,KAOclF,IAAKA,EAAKG,QAASyD,WCjD1EC,IAAOC,KAAK,gBAEZqB,IAASC,OAAO,cAAC,EAAD,IAASd,SAASe,eAAe,W","file":"static/js/main.e169943c.chunk.js","sourcesContent":["import React, {useEffect, useState} from 'react';\nimport PropTypes from 'prop-types';\n\nimport {Panel, PanelHeader, Header, Button, Group, Cell, Div, Avatar} from '@vkontakte/vkui';\n\nconst Home = ({id, go, fetchedUser, pos, gyrData}) => {\n    const [X, setX] = useState(0)\n    const [Y, setY] = useState(0)\n    const [dX, setdX] = useState(0)\n    const [dY, setdY] = useState(0)\n    const [d, setD] = useState({a:0, b:0, c:0})\n\n    const N = 16\n    const CELL_WIDTH = 20\n    const CELL_HEIGHT = 20\n    const USER_WIDTH = CELL_WIDTH / 2\n    const USER_HEIGHT = CELL_HEIGHT / 2\n\n    const MAP_WIDTH = N * CELL_WIDTH\n    const MAP_HEIGHT = N * CELL_HEIGHT\n\n    useEffect(()=>{\n        // console.log(2)\n\n        move(pos.x, pos.y)\n    }, [pos])\n\n    const contain = (w, a) => {\n        return w[0] <= a[0] && a[0] <= w[0] + CELL_WIDTH &&\n            w[1] <= a[1] && a[1] <= w[1] + CELL_HEIGHT\n    }\n\n    const isValid = (x, y) => {\n        const walls = getWalls()\n        if (x < 0 || x >= MAP_WIDTH || y < 0 || y >= MAP_HEIGHT) return false\n\n        // x = x - CELL_WIDTH\n        // y = y - CELL_HEIGHT\n        let a = [x, y]\n        let b = [x + USER_WIDTH, y]\n        let c = [x, y + USER_HEIGHT]\n        let d = [x + USER_WIDTH, y + USER_HEIGHT]\n\n\n        for (let i = 0; i < walls.length; i++) {\n            let w = walls[i]\n            if (contain(w, a) || contain(w, b) || contain(w, c) || contain(w, d))\n                return false\n        }\n        return true\n    }\n\n    const move = (dx, dy) => {\n        let x = X\n        let y = Y\n        if (x === undefined || isNaN(x)) {\n            x = MAP_WIDTH / 2\n        }\n        if (y === undefined || isNaN(y)) {\n            y = MAP_HEIGHT / 2\n        }\n        console.log(x + \" \" + y)\n        if (isValid(x + dx, y))\n            x += dx\n        else\n            x -= dx\n        if (isValid(x,y + dy))\n            y += dy\n        else\n            y -= dy\n        // console.log(dx + \" \" + dy)\n        setX(x)\n        setY(y)\n    }\n\n\n    const getWalls = () => {\n        let m = [\n            \"0000000000000000\",\n            \"0000111111100000\",\n            \"0011100010111110\",\n            \"0010100010100010\",\n            \"0000000010101010\",\n            \"0111111110111010\",\n            \"0010100000101010\",\n            \"0111100111101010\",\n            \"0010100110001010\",\n            \"0010100000001010\",\n            \"0010111111101010\",\n            \"0010000001001010\",\n            \"0110111111001010\",\n            \"0010100000001110\",\n            \"0010111011111000\",\n            \"0000001000000000\"]\n        let wls = []\n        for (let i = 0; i < N; i++) {\n            for (let j = 0; j < N; j++) {\n                if (m[i][j] === '0')\n                    wls.push([j * CELL_WIDTH, i * CELL_HEIGHT])\n            }\n        }\n        return wls\n    }\n    const walls = getWalls()\n\n    return (\n        <Panel id={id} style={{backgroundColor: \"#AAAAAA\"}}>\n            <Div style={{margin: \"auto\", width: \"100px\", height: \"100px\", padding: \"0px\"}}>\n                {walls.map((w) => {\n                    return <Div key={w[0] * 100 + w[1]}\n                                style={{position: \"fixed\",\n                                    padding:\"0\",\n                                    width:CELL_WIDTH, height:CELL_HEIGHT,\n                                    left: w[0], top: w[1], backgroundColor: \"#DDDDDD\"}}/>\n\n                })}\n            </Div>\n\n            <Div style={{position: \"absolute\",\n                padding:\"0\",\n                width:USER_WIDTH, height:USER_HEIGHT,\n                left: X, top: Y,\n                backgroundColor: \"#000000\"}}/>\n            <Div>1</Div>\n            <Div style={{marginTop:\"auto\", marginBottom:\"0\"}}>\n                x={gyrData.x}\n            </Div>\n            <Div>\n                y={gyrData.y}\n            </Div>\n            <Div>\n                z={gyrData.z}\n            </Div>\n        </Panel>\n    );\n}\n\n\nexport default Home;\n","import React, { useState, useEffect } from 'react';\nimport bridge from '@vkontakte/vk-bridge';\nimport { View, ScreenSpinner, AdaptivityProvider, AppRoot } from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\n\nimport Home from './panels/Home';\n\nconst App = () => {\n\tconst [activePanel, setActivePanel] = useState('home');\n\tconst [fetchedUser, setUser] = useState(null);\n\tconst [popout, setPopout] = useState(<ScreenSpinner size='large' />);\n\tconst [pos, setPos] = useState([0, 0])\n\tconst [gyr, setGyr] = useState({x:0,y:0,z:0})\n\n\tconst getPos = (gyrData) => {\n\t\treturn [1, 1]\n\t}\n\n\tuseEffect(() => {\n\t\tbridge.subscribe(({ detail: { type, data }}) => {\n\t\t\tif (type === 'VKWebAppUpdateConfig') {\n\t\t\t\tconst schemeAttribute = document.createAttribute('scheme');\n\t\t\t\tschemeAttribute.value = data.scheme ? data.scheme : 'client_light';\n\t\t\t\tdocument.body.attributes.setNamedItem(schemeAttribute);\n\t\t\t} else if (type === 'VKWebAppGyroscopeChanged') {\n\t\t\t\tsetPos({x: data.x * 10, y: data.y * 10});\n\t\t\t\t// setGyr(data)\n\t\t\t\t// let p = getPos(data)\n\t\t\t\t// setPos(p)\n\t\t\t}\n\t\t});\n\t\tasync function fetchData() {\n\t\t\tbridge.send(\"VKWebAppGyroscopeStart\", {\"refresh_rate\": 1000});\n\t\t\tsetPopout(null);\n\t\t\tconst user = await bridge.send('VKWebAppGetUserInfo');\n\t\t\tsetUser(user);\n\t\t}\n\t\tasync function fakeGyr() {\n\t\t\tsetInterval(() => {\n\t\t\t\t// console.log(1)\n\t\t\t\tsetPos({x:1, y:-1})\n\t\t\t}, 100)\n\t\t}\n\t\tfetchData();\n\t\tfakeGyr();\n\t}, []);\n\n\tconst go = e => {\n\t\tsetActivePanel(e.currentTarget.dataset.to);\n\t};\n\n\treturn (\n\t\t<AdaptivityProvider>\n\t\t\t<AppRoot>\n\t\t\t\t<View activePanel={activePanel} popout={popout}>\n\t\t\t\t\t<Home id='home' fetchedUser={fetchedUser} go={go} pos={pos} gyrData={gyr}/>\n\t\t\t\t</View>\n\t\t\t</AppRoot>\n\t\t</AdaptivityProvider>\n\t);\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport bridge from \"@vkontakte/vk-bridge\";\nimport App from \"./App\";\n\n// Init VK  Mini App\nbridge.send(\"VKWebAppInit\");\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\nif (process.env.NODE_ENV === \"development\") {\n  import(\"./eruda\").then(({ default: eruda }) => {}); //runtime download\n}\n"],"sourceRoot":""}